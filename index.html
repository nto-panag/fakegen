<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <title>fake plan ÎºÎ±Î¹ Attact plan</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.js"></script>
    <style>
        body { background-image: url('bg-tile.jpg'); background-repeat: repeat; color: #3e2723; font-family: 'Segoe UI', Tahoma, sans-serif; padding: 10px; font-size: 16px; } 
        .container { max-width: 1150px; margin: auto; background: rgba(252, 244, 230, 0.96); padding: 15px; border: 2px solid #8b4513; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .header-feng { text-align: center; margin-bottom: 5px; }
        .header-feng h1 { color: #8b4513; margin: 0; font-size: 28px; }
        .header-feng h1 span.vivi { color: #ff0000; font-weight: bold; }
        #date_display { text-align: center; font-weight: bold; font-size: 24px; color: #8b0000; margin-bottom: 15px; }
        .inline-row { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; border-top: 2px solid #8b4513; padding-top: 10px; font-weight: bold; font-size: 13px; flex-wrap: wrap; }
        .small-input { width: 30px !important; text-align: center; border: 1px solid #8b4513; }
        .sleep-select { border: 1px solid #d63384; background: #fff0f5; font-weight: bold; color: #d63384; border-radius: 4px; }
        textarea { width: 100%; height: 115px; border: 1px solid #8b4513; font-family: monospace; font-size: 16px; padding: 10px; box-sizing: border-box; }
        .btn-calc { background-color: #43b581; color: white; padding: 14px; border: 1px solid #274d32; border-radius: 4px; cursor: pointer; width: 100%; font-weight: bold; font-size: 18px; margin-top: 10px; }
        .btn-copy { background-color: #8b4513; color: white; padding: 12px; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 8px; display: none; }
        .vis-table { width: 100%; border-collapse: collapse; }
        .vis-table th, .vis-table td { border: 1px solid #7d5d3b; padding: 8px; text-align: center; }
        .launch-time { color: #ff0000; font-weight: bold; }
        .footer-gemini { text-align: center; margin-top: 18px; font-size: 14px; font-weight: bold; color: #5d2e0d; border-top: 3px dashed #8b4513; padding-top: 15px; }
    </style>
</head>
<body>
<div class="container">
    <div class="header-feng"><h1>Attact + fake plan by feng <span class="vivi">for SCR</span></h1><p>Î’Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„Î·Ï‚ Sophie (Shinko to Kuma)</p></div>
    <div id="date_display"></div>
<h2 style="text-align: center; font-size: 14px; color: #5d2e0d; margin-top: 0;">Î£Ï…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚: Copy Î±Ï€ÏŒ MAP Script Î® 6 Î½Î¿ÏÎ¼ÎµÏÎ± (Ï€.Ï‡. 500500)</h2>
  <h2 style="text-align: center; font-size: 14px; color: #5c2e0d; margin-top: 0;">Î²Î³Î±Î¶Î¿Ï…Î¼Îµ Î¼Î¹Î± Ï†Î¿ÏÎ± Î³Î¹Î± Ï„Î¿ Ï€Î»Î±Î½Î¿ ÎºÎ±Î¹ Î±Î»Î»Î· Î¼Î¹Î± Î¼Îµ 1sec Î¼ÎµÏ„Î¬ Î±Î½ Î¸ÎµÎ»Î¿Ï…Î¼Îµ Î½Î± ÎºÎ¿Î»Î·ÏƒÎ¿Ï…Î¼Îµ Î±Î¼Ï…Î½ÎµÏ‚, Î³Î¹Î± Ï„Î¿ Ï€Î¹Î¸Î±Î½ÏŒ lag</h2>

    <div class="inline-row">
        <label>Î†Ï†Î¹Î¾Î·:</label><input type="text" id="datetimepicker" style="width:130px;" readonly>
        
        <label>ÎœÎ¿Î½Î¬Î´Î±:</label>
        <select id="unit">
			<option value="35">Î‘ÏÎ¹ÏƒÏ„Î¿ÎºÏÎ¬Ï„Î·Ï‚</option>
            <option value="30">ÎšÏÎ¹ÏŒÏ‚</option>
            <option value="9">Î‘Î½Î¹Ï‡Î½ÎµÏ…Ï„Î®Ï‚</option>
			<option value="11">Î’Î±ÏÏ (Î³Î¹Î± Î¬Î¼Ï…Î½Î±)</option>
			<option disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>
			<option value="10">Î Î±Î»Î±Î½Ï„Î¯Î½ (Î³Î¹Î± Î¬Î¼Ï…Î½Î±)</option>
			<option value="18">Î”ÏŒÏÏ… (Î³Î¹Î± Î¬Î¼Ï…Î½Î±)</option>
            <option value="22">ÎÎ¯Ï†Î¿Ï‚ (Î±ÏÎ³ÏŒ Î³Î¹Î± Î¬Î¼Ï…Î½Î±)</option>
			<option value="11">Î’Î±ÏÏ (Î³Î¹Î± Î¬Î¼Ï…Î½Î±)</option>
        </select>
        <label>Îš:</label><input type="text" id="world_speed" class="small-input" value="1.2">
        <label>Îœ:</label><input type="text" id="unit_speed" class="small-input" value="0.8">
        
        <label style="color:#d63384; margin-left:5px;">ğŸ’¤ ÎšÎ¿Î¹Î¼Î¬Î¼Îµ Î±Ï€ÏŒ:</label>
        <select id="sleep_from" class="sleep-select">
            <option value="0">00:00</option><option value="1">01:00</option><option value="2">02:00</option><option value="3">03:00</option><option value="4">04:00</option><option value="5">05:00</option><option value="6">06:00</option><option value="7">07:00</option><option value="8">08:00</option><option value="9">09:00</option><option value="10">10:00</option><option value="11">11:00</option><option value="12">12:00</option><option value="13">13:00</option><option value="14">14:00</option><option value="15">15:00</option><option value="16">16:00</option><option value="17">17:00</option><option value="18">18:00</option><option value="19">19:00</option><option value="20">20:00</option><option value="21">21:00</option><option value="22">22:00</option><option value="23">23:00</option>
        </select>
        <label style="color:#d63384;">Î­Ï‰Ï‚:</label>
        <select id="sleep_to" class="sleep-select">
            <option value="0">00:00</option><option value="1">01:00</option><option value="2">02:00</option><option value="3">03:00</option><option value="4">04:00</option><option value="5">05:00</option><option value="6">06:00</option><option value="7" selected>07:00</option><option value="8">08:00</option><option value="9">09:00</option><option value="10">10:00</option><option value="11">11:00</option><option value="12">12:00</option><option value="13">13:00</option><option value="14">14:00</option><option value="15">15:00</option><option value="16">16:00</option><option value="17">17:00</option><option value="18">18:00</option><option value="19">19:00</option><option value="20">20:00</option><option value="21">21:00</option><option value="22">22:00</option><option value="23">23:00</option>
        </select>
        
        <label style="margin-left:10px; background:#fce4ec; padding:2px 5px; border-radius:4px;">
            <input type="checkbox" id="no_sleep"> <b>Î”ÎµÎ½ ÎºÎ¿Î¹Î¼Î¬Î¼Î±Î¹</b>
        </label>
<h2 style="text-align: center; font-size: 14px; color: #3129c2; margin: 10px 0; width: 100%;">Î ÎµÎ¹Î½Ï‰ â˜•ï¸ ÎºÎ±Î¹ Î´ÎµÎ½ ÎºÎ¿Î¹Î¼Î¬Î¼Î±Î¹ .Î¿ [Î”Î¹Î¿Î½ÏÏƒÎ·Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒ]</h2>    </div>
    <div style="display:flex; gap:12px;">
        <div style="flex:1;"><textarea id="sources" oninput="autoCoord(this)" placeholder="Nukes"></textarea></div>
        <div style="flex:1;"><textarea id="targets" oninput="autoCoord(this)" placeholder="Î£Ï„ÏŒÏ‡Î¿Î¹"></textarea></div>
    </div>
    <button class="btn-calc" onclick="calculatePlan()">Î¦Î¤Î™Î‘ÎÎ• Î Î›Î‘ÎÎŸ & Î¤Î‘ÎÎ™ÎÎŸÎœÎ—Î£Î•</button>
    <button id="copyBtn" class="btn-copy" onclick="copyToClipboard()">ğŸ“‘ Î‘ÎÎ¤Î™Î“Î¡Î‘Î¦Î— BB-CODE</button>
    <div id="spoiler" style="display:none; margin-top:15px;"><div id="results_table"></div></div>
    <div class="footer-gemini">âœ¨Î’Î¿Î·Î¸Î¬ÎµÎ¹ Î¿ Gemini 3 AI</div>
</div>
<audio id="alertSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
function autoCoord(el) {
    let val = el.value.replace(/[^0-9\n|]/g, '');
    let lines = val.split('\n');
    let newLines = lines.map(line => {
        let clean = line.replace(/[^0-9]/g, '');
        if (clean.length === 6 && !line.includes('|')) return clean.substring(0, 3) + '|' + clean.substring(3, 6) + '\n';
        return line;
    });
    el.value = newLines.join('\n').replace(/\n\n/g, '\n');
}

function updateServerTime() {
    var t = new Date();
    document.getElementById('date_display').innerHTML = "ÎÏÎ± server: " + ("0" + t.getHours()).slice(-2) + ":" + ("0" + t.getMinutes()).slice(-2) + ":" + ("0" + t.getSeconds()).slice(-2);
}
setInterval(updateServerTime, 1000);

$(function() { 
    $('#datetimepicker').datetimepicker({ dateFormat: 'dd/mm/yy', timeFormat: 'HH:mm:ss' }); 
    $('#datetimepicker').datetimepicker('setDate', new Date()); 
});

function calculatePlan() {
    const hitTimeStr = $('#datetimepicker').val();
    const parts = hitTimeStr.match(/(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2}):(\d{2})/);
    const hitTimeMs = new Date(parts[3], parts[2]-1, parts[1], parts[4], parts[5], parts[6]).getTime();
    
    // Î•Ï€Î¹Î»Î¿Î³Î® Ï„Î±Ï‡ÏÏ„Î·Ï„Î±Ï‚ Î²Î¬ÏƒÎµÎ¹ Î¼Î¿Î½Î¬Î´Î±Ï‚
    const unitValue = parseFloat($('#unit').val());
const unitIcon = unitValue === 9 ? "spy" : (unitValue === 35 ? "snob" : (unitValue === 10 ? "knight" : (unitValue === 11 ? "heavy" : (unitValue === 18 ? "spear" : (unitValue === 22 ? "sword" : "ram")))));    
    const msPerField = (unitValue / (parseFloat($('#world_speed').val()) * parseFloat($('#unit_speed').val()))) * 60 * 1000;
    const sources = $('#sources').val().trim().split('\n'), targets = $('#targets').val().trim().split('\n');
    const sFrom = parseInt($('#sleep_from').val()), sTo = parseInt($('#sleep_to').val());
    const isNoSleep = $('#no_sleep').is(':checked');
    let attacks = [];

    sources.forEach(s => {
        targets.forEach(t => {
            const sC = s.match(/(\d+)\|(\d+)/), tC = t.match(/(\d+)\|(\d+)/);
            if (sC && tC) {
                const dist = Math.sqrt(Math.pow(sC[1]-tC[1], 2) + Math.pow(sC[2]-tC[2], 2));
                const lMs = hitTimeMs - (dist * msPerField);
                const d = new Date(lMs);
                const lHour = d.getHours();
                if (!isNoSleep && (lHour >= sFrom && lHour < sTo)) return;
                const lStr = ("0" + d.getHours()).slice(-2) + ":" + ("0" + d.getMinutes()).slice(-2) + ":" + ("0" + d.getSeconds()).slice(-2) + " " + ("0" + d.getDate()).slice(-2) + "/" + ("0" + (d.getMonth() + 1)).slice(-2);
                attacks.push({ from: s.trim(), to: t.trim(), lMs: lMs, lStr: lStr });
            }
        });
    });

    attacks.sort((a, b) => a.lMs - b.lMs);
    let tableHtml = `<table class="vis-table"><tr><th>Î‘Ï€ÏŒ</th><th>Î ÏÎ¿Ï‚</th><th>Î•ÎºÎºÎ¯Î½Î·ÏƒÎ·</th></tr>`;
    let bb = "";
    attacks.forEach((att) => {
        tableHtml += `<tr><td>${att.from}</td><td>${att.to}</td><td class="launch-time">${att.lStr}</td></tr>`;
        bb += `[unit]${unitIcon}[/unit] [coord]${att.from}[/coord] -> [coord]${att.to}[/coord] | [b][color=#ff0000]${att.lStr}[/color][/b]\n`;
    });
    $('#results_table').html(tableHtml + "</table>");
    $('#bbcopy').remove(); $('body').append(`<textarea id="bbcopy" style="display:none;">${bb}</textarea>`);
    $('#spoiler').show(); $('#copyBtn').show();
    document.getElementById('alertSound').play();
}

function copyToClipboard() {
    var c = document.getElementById("bbcopy"); 
    c.style.display = "block"; 
    c.select(); 
    document.execCommand("copy"); 
    c.style.display = "none";
    var btn = document.getElementById("copyBtn"); 
    btn.innerHTML = "âœ… Î‘ÎÎ¤Î™Î“Î¡Î‘Î¦Î—ÎšÎ•!"; 
    setTimeout(function(){ btn.innerHTML = "ğŸ“‘ Î‘ÎÎ¤Î™Î“Î¡Î‘Î¦Î— BB-CODE"; }, 2000);
}
</script>
</body>
</html>
